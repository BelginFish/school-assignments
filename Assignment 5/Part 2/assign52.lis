                        .module assign52.c
                        .area text
 0000                   .dbfile M:\SYSC20~2\Assignments\ASSIGM~1\PART2~1/../lib/motor.c
 0000                   .dbfunc e motor_init _motor_init fV
 0000           _motor_init::
 0000                   .dbline -1
 0000                   .dbline 12
 0000           ; // By Korey Conway and Tanzeel Rana
 0000           ; 
 0000           ; #include <hcs12dp256.h>
 0000           ; #include <stdio.h>
 0000           ; #include "../lib/motor.c"
 0000           ; 
 0000           ; int main()
 0000           ; {
 0000           ;       char key;
 0000           ;       int duty;
 0000           ;       unsigned int i;
 0000           ;       
 0000                   .dbline 14
 0000           ;       // Setup terminal
 0000           ;       setbaud(BAUD19K);
 0000 1C00A180          bset 0xa1,#128
 0004                   .dbline 15
 0004           ;       
 0004 1D00A480          bclr 0xa4,#0x80
 0008                   .dbline 16
 0008           ;       motor_init();
 0008 1D00A580          bclr 0xa5,#0x80
 000C                   .dbline 17
 000C           ;       optical_init();
 000C C6FF              ldab #255
 000E 7B00A9            stab 0xa9
 0011                   .dbline 18
 0011           ;       
 0011 C663              ldab #99
 0013 7B00BB            stab 0xbb
 0016                   .dbline 19
 0016           ;       INTR_ON();
 0016 1D00A370          bclr 0xa3,#0x70
 001A                   .dbline 20
 001A           ;       
 001A 1C025A40          bset 0x25a,#64
 001E                   .dbline 21
 001E           ;       motor_set_duty(50);
 001E 1C025840          bset 0x258,#64
 0022                   .dbline 22
 0022           ;       
 0022 7900C3            clr 0xc3
 0025                   .dbline 23
 0025           ;       while ( 1 ) {
 0025 1C00A080          bset 0xa0,#128
 0029                   .dbline -2
 0029                   .dbline 24
 0029           ;               // for ( duty = 25; duty <= 50; duty++ ) {
 0029           L3:
 0029                   .dbline 0 ; func end
 0029 3D                rts
 002A                   .dbend
 002A                   .dbfunc e motor_set_duty _motor_set_duty fV
 002A           ;           duty -> 2,x
 002A           _motor_set_duty::
 002A 3B                pshd
 002B 34                pshx
 002C B775              tfr s,x
 002E                   .dbline -1
 002E                   .dbline 30
 002E                   .dbline 31
 002E EC02              ldd 2,x
 0030 2D0C              blt L5
 0032 EC02              ldd 2,x
 0034 8C0032            cpd #50
 0037 2E05              bgt L5
 0039                   .dbline 31
 0039                   .dbline 32
 0039 EC02              ldd 2,x
 003B 7B00C3            stab 0xc3
 003E                   .dbline 33
 003E           L5:
 003E                   .dbline -2
 003E                   .dbline 34
 003E           ;                       // motor_set_duty(duty);
 003E           ;                       // for ( i = 0; i < -1; i++ ) {}
 003E           ;               // }
 003E           ;       
 003E           ;               // for ( duty = 50; duty >= 25; duty-- ) {
 003E           ;                       // motor_set_duty(duty);                
 003E           ;                       // for ( i = 0; i < -1; i++ ) {}
 003E           ;               // }
 003E           ;       }
 003E           ;       
 003E           L4:
 003E B757              tfr x,s
 0040 30                pulx
 0041 1B82              leas 2,sp
 0043                   .dbline 0 ; func end
 0043 3D                rts
 0044                   .dbsym l duty 2 I
 0044                   .dbend
 0044                   .dbfunc e optical_init _optical_init fV
 0044           _optical_init::
 0044                   .dbline -1
 0044                   .dbline 37
 0044           ;       return 0;
 0044           ; }
 0044           ; }
 0044                   .dbline 40
 0044           ; }
 0044           ; }
 0044           ; }
 0044 1C004A40          bset 0x4a,#64
 0048                   .dbline 41
 0048           ; }
 0048 1C004C80          bset 0x4c,#128
 004C                   .dbline 42
 004C           ; }
 004C 1D004080          bclr 0x40,#0x80
 0050                   .dbline 43
 0050           ; }
 0050 1C004D07          bset 0x4d,#7
 0054                   .dbline 44
 0054           ; }
 0054 1C004690          bset 0x46,#144
 0058                   .dbline -2
 0058                   .dbline 45
 0058           ; }
 0058           L7:
 0058                   .dbline 0 ; func end
 0058 3D                rts
 0059                   .dbend
                        .area data
 0000                   .dbfile M:\SYSC20~2\Assignments\ASSIGM~1\PART2~1/../lib/motor.c
 0000           L9:
 0000                   .blkb 2
                        .area idata
 0000 0000              .word 0
                        .area data
 0002                   .dbfile M:\SYSC20~2\Assignments\ASSIGM~1\PART2~1/../lib/motor.c
                        .area text
 0059                   .dbfile M:\SYSC20~2\Assignments\ASSIGM~1\PART2~1/../lib/motor.c
 0059                   .dbfunc e optical_isr _optical_isr fV
 0059                   .dbsym s start L9 I
 0059           ;           time -> -2,x
 0059           _optical_isr::
 0059 34                pshx
 005A B775              tfr s,x
 005C 1B9C              leas -4,sp
 005E                   .dbline -1
 005E                   .dbline 49
 005E           ; ä
 005E           ; ä
 005E           ; ä
 005E           ; ä
 005E                   .dbline 51
 005E           ; ä
 005E           ; ä
 005E CC0000            ldd #0
 0061 6C1E              std -2,x
 0063                   .dbline 53
 0063           ; ä
 0063           ; ä
 0063 FC0000            ldd L9
 0066 271A              beq L10
 0068                   .dbline 53
 0068                   .dbline 54
 0068           ; ä
 0068                   ; vol
 0068 FC0044            ldd 0x44
 006B B30000            subd L9
 006E 6C1E              std -2,x
 0070                   .dbline 55
 0070           ; ä
 0070 CC0000            ldd #0
 0073 7C0000            std L9
 0076                   .dbline 56
 0076           ; ä
 0076 18021E80          movw -2,x,0,sp
 007A CC00B4            ldd #L12
 007D 160000            jsr _printf
 0080                   .dbline 57
 0080 2006              bra L11
 0082           L10:
 0082                   .dbline 57
 0082           ; ä
 0082                   .dbline 58
 0082           ; ä
 0082                   ; vol
 0082 FC0044            ldd 0x44
 0085 7C0000            std L9
 0088                   .dbline 59
 0088           ; ä
 0088           L11:
 0088                   .dbline 61
 0088           ; ä
 0088           ; ä
 0088                   ; vol
 0088 F6004E            ldab 0x4e
 008B 7B004E            stab 0x4e
 008E                   .dbline -2
 008E                   .dbline 64
 008E           ; ä
 008E           ; ä
 008E           ; ä
 008E           L8:
 008E B757              tfr x,s
 0090 30                pulx
 0091                   .dbline 0 ; func end
 0091 0B                rti
 0092                   .dbsym l time -2 I
 0092                   .dbend
 0092                   .dbfile M:\SYSC20~2\Assignments\ASSIGM~1\PART2~1\assign52.c
 0092                   .dbfunc e main _main fI
 0092           ;              i -> -5,x
 0092           ;           duty -> -3,x
 0092           ;            key -> -1,x
 0092           _main::
 0092 34                pshx
 0093 B775              tfr s,x
 0095 1B9A              leas -6,sp
 0097                   .dbline -1
 0097                   .dbline 8
 0097                   .dbline 14
 0097 CC001A            ldd #26
 009A 160000            jsr _setbaud
 009D                   .dbline 16
 009D 160000            jsr _motor_init
 00A0                   .dbline 17
 00A0 160044            jsr _optical_init
 00A3                   .dbline 19
 00A3 10EF                      cli
 00A5           
 00A5                   .dbline 21
 00A5 CC0032            ldd #50
 00A8 16002A            jsr _motor_set_duty
 00AB           L14:
 00AB                   .dbline 23
 00AB                   .dbline 33
 00AB           L15:
 00AB                   .dbline 23
 00AB 20FE              bra L14
 00AD           X0:
 00AD                   .dbline 35
 00AD CC0000            ldd #0
 00B0                   .dbline -2
 00B0           L13:
 00B0 B757              tfr x,s
 00B2 30                pulx
 00B3                   .dbline 0 ; func end
 00B3 3D                rts
 00B4                   .dbsym l i -5 i
 00B4                   .dbsym l duty -3 I
 00B4                   .dbsym l key -1 c
 00B4                   .dbend
 00B4           L12:
 00B4 25750A00          .byte 37,'u,10,0
