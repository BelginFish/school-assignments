WARNING: EXTCODE CODE AREA DO NOT CONTAIN RELOCATED ADDRESSES.
THIS WILL BE REMEDIED IN A LATER RELEASE.
                        .module assign41.c
                        .area text
--- 0000                   .dbfile M:\SYSC20~2\Assignments\ASSIGN~3\PART1~1/../lib/keyboard.c
--- 0000                   .dbfunc s keyboard_init _keyboard_init fV
--- 0000           _keyboard_init:
--- 0000                   .dbline -1
--- 0000                   .dbline 17
--- 0000           ; #include <hcs12dp256.h>
--- 0000           ; #include <stdio.h>
--- 0000           ; #include "../lib/keyboard.c"
--- 0000           ; 
--- 0000           ; int main()
--- 0000           ; {
--- 0000           ;       char key;
--- 0000           ;       
--- 0000           ;       // Setup terminal
--- 0000           ;       setbaud(BAUD19K);
--- 0000           ;       
--- 0000           ;       while ( 1 ) {
--- 0000           ;               key = keyboard_getchar();
--- 0000           ;               putchar(key);
--- 0000           ;               
--- 0000           ;               if ( key == '0' ) {
--- 0000           ;                       break;
--- 0000                   .dbline 18
--- 0000           ;               }
--- 0000 7900F0            clr 0xf0
--- 0003                   .dbline 19
--- 0003           ;       }
--- 0003 C60F              ldab #15
--- 0005 7B025A            stab 0x25a
--- 0008                   .dbline 20
--- 0008           ;       
--- 0008 1D0262F0          bclr 0x262,#0xf0
--- 000C                   .dbline -2
--- 000C                   .dbline 21
--- 000C           ;       return 1;
--- 000C           L3:
--- 000C                   .dbline 0 ; func end
--- 000C 3D                rts
--- 000D                   .dbend
                        .area data
--- 0000                   .dbfile M:\SYSC20~2\Assignments\ASSIGN~3\PART1~1/../lib/keyboard.c
--- 0000           L5:
--- 0000                   .blkb 2
                        .area idata
--- 0000 FFFF              .word -1
                        .area data
--- 0002                   .dbfile M:\SYSC20~2\Assignments\ASSIGN~3\PART1~1/../lib/keyboard.c
--- 0002           L6:
--- 0002                   .blkb 2
                        .area idata
--- 0002 FFFF              .word -1
                        .area data
--- 0004                   .dbfile M:\SYSC20~2\Assignments\ASSIGN~3\PART1~1/../lib/keyboard.c
                        .area text
--- 000D                   .dbfile M:\SYSC20~2\Assignments\ASSIGN~3\PART1~1/../lib/keyboard.c
--- 000D           L7:
--- 000D 3132              .byte 49,50
--- 000F 3341              .byte 51,'A
--- 0011 3435              .byte 52,53
--- 0013 3642              .byte 54,'B
--- 0015 3738              .byte 55,56
--- 0017 3943              .byte 57,'C
--- 0019 4530              .byte 'E,48
--- 001B 4644              .byte 'F,'D
--- 001D                   .dbfunc e keyboard_getchar _keyboard_getchar fc
--- 001D                   .dbsym s last_col L6 I
--- 001D                   .dbsym s last_row L5 I
--- 001D           ;       char_map -> -20,x
--- 001D           ;            col -> -4,x
--- 001D           ;            row -> -2,x
 4047            _keyboard_getchar::
 4047  34                pshx
 4048  B775              tfr s,x
 404A  1BF1E6            leas -26,sp
 404D                    .dbline -1
 404D                    .dbline 27
 404D            ; }
 404D            ; }
 404D            ; }
 404D            ; }
 404D            ; }
 404D            ; }
 404D                    .dbline 30
 404D            ; }
 404D            ; }
 404D            ; }
 404D  CC0000            ldd #0
 4050  6C1E              std -2,x
 4052                    .dbline 31
 4052            ; }
 4052  CC0000            ldd #0
 4055  6C1C              std -4,x
 4057                    .dbline 33
 4057            ; }
 4057            ; }
 4057  19E1EC            leay -20,x
 405A  B7C6              xgdy
 405C  CD4037            ldy #L7
 405F  34                pshx
 4060  B745              tfr d,x
 4062  CC0008            ldd #8
 4065            X0:
 4065  18027131          movw 2,y+,2,x+
 4069  0434F9            dbne d,X0
 406C  30                pulx
 406D                    .dbline 38
 406D            ; }
 406D            ; }
 406D            ; }
 406D            ; }
 406D            ; }
 406D  16402A            jsr _keyboard_init
 4070  18200089          lbra L9
 4074            L8:
 4074                    .dbline 40
 4074            ; }
 4074            ; }
 4074                    .dbline 41
 4074            ; }
 4074  CC0001            ldd #1
 4077  ED1E              ldy -2,x
 4079  8D0000            cpy #0
 407C  2704              beq X1
 407E            X2:
 407E  59                lsld
 407F  0436FC            dbne y,X2
 4082            X1:
 4082  7B0258            stab 0x258
 4085                    .dbline 42
 4085            ; }
 4085  164108            jsr _keyboard_get_column
 4088  6C1C              std -4,x
 408A                    .dbline 45
 408A            ; }
 408A            ; }
 408A            ; }
 408A  EC1C              ldd -4,x
 408C  8CFFFF            cpd #-1
 408F  274F              beq L11
 4091                    .dbline 45
 4091                    .dbline 46
 4091            ; }
 4091  FC1000            ldd L5
 4094  AC1E              cpd -2,x
 4096  260F              bne L13
 4098  FC1002            ldd L6
 409B  AC1C              cpd -4,x
 409D  2608              bne L13
 409F                    .dbline 46
 409F                    .dbline 47
 409F            ; }
 409F  CCF000            ldd #0xf000
 40A2  16415E            jsr _keyboard_delay
 40A5                    .dbline 48
 40A5  2006              bra L14
 40A7            L13:
 40A7                    .dbline 48
 40A7            ; }
 40A7                    .dbline 49
 40A7            ; }
 40A7  CC5000            ldd #20480
 40AA  16415E            jsr _keyboard_delay
 40AD                    .dbline 50
 40AD            ; }
 40AD            L14:
 40AD                    .dbline 53
 40AD            ; }
 40AD            ; }
 40AD            ; }
 40AD  164108            jsr _keyboard_get_column
 40B0  6CE1EA            std -22,x
 40B3  EC1C              ldd -4,x
 40B5  ACE1EA            cpd -22,x
 40B8  2633              bne L12
 40BA                    .dbline 53
 40BA                    .dbline 55
 40BA            ; }
 40BA            ; }
 40BA  18051E1000        movw -2,x,L5
 40BF                    .dbline 56
 40BF            ; }
 40BF  18051C1002        movw -4,x,L6
 40C4                    .dbline 57
 40C4            ; }
 40C4  EC1E              ldd -2,x
 40C6  59                lsld
 40C7  59                lsld
 40C8  19E1EC            leay -20,x
 40CB  6DE1E8            sty -24,x
 40CE  E3E1E8            addd -24,x
 40D1  6CE1E6            std -26,x
 40D4  EC1C              ldd -4,x
 40D6  E3E1E6            addd -26,x
 40D9  B7C6              xgdy
 40DB  E640              ldab 0,y
 40DD  87                clra
 40DE  2024              bra L4
 40E0            X3:
 40E0                    .dbline 59
 40E0            L11:
 40E0                    .dbline 59
 40E0            ; }
 40E0            ; }
 40E0  EC1E              ldd -2,x
 40E2  BC1000            cpd L5
 40E5  2606              bne L17
 40E7                    .dbline 59
 40E7                    .dbline 61
 40E7            ; }
 40E7            ; }
 40E7  CCFFFF            ldd #-1
 40EA  7C1002            std L6
 40ED                    .dbline 62
 40ED            ; }
 40ED            L17:
 40ED            L12:
 40ED                    .dbline 65
 40ED  EC1E              ldd -2,x
 40EF  C30001            addd #1
 40F2  CD0004            ldy #4
 40F5  B7D6              exg x,y
 40F7  1815              idivs
 40F9  B7D6              exg x,y
 40FB  6C1E              std -2,x
 40FD                    .dbline 66
 40FD            L9:
 40FD                    .dbline 40
 40FD  1820FF73          lbra L8
 4101            X4:
 4101                    .dbline 68
 4101            ; }
 4101            ; }
 4101            ; }
 4101            ; }
 4101            ; }
 4101            ; }
 4101  CC0000            ldd #0
 4104                    .dbline -2
 4104            L4:
 4104  B757              tfr x,s
 4106  30                pulx
 4107                    .dbline 0 ; func end
 4107  3D                rts
 4108                    .dbsym l char_map -20 A[16:4:4]c
 4108                    .dbsym l col -4 I
 4108                    .dbsym l row -2 I
 4108                    .dbend
 4108                    .dbfunc s keyboard_get_column _keyboard_get_column fI
 4108            ;          input -> -4,x
 4108            ;            col -> -2,x
 4108            _keyboard_get_column:
 4108  34                pshx
 4109  B775              tfr s,x
 410B  1B9C              leas -4,sp
 410D                    .dbline -1
 410D                    .dbline 76
 410D            ; ä
 410D            ; ä
 410D            ; ä
 410D            ; ä
 410D            ; ä
 410D            ; ä
 410D            ; ä
 410D            ; ä
 410D                    .dbline 77
 410D            ; ä
 410D  CC0000            ldd #0
 4110  6C1E              std -2,x
 4112                    .dbline 78
 4112            ; ä
 4112                    ; vol
 4112  F60260            ldab 0x260
 4115  87                clra
 4116  47                asra
 4117  56                rorb
 4118  47                asra
 4119  56                rorb
 411A  47                asra
 411B  56                rorb
 411C  47                asra
 411D  56                rorb
 411E  6C1C              std -4,x
 4120                    .dbline 81
 4120            ; ä
 4120            ; ä
 4120            ; ä
 4120  EC1C              ldd -4,x
 4122  2605              bne L20
 4124                    .dbline 81
 4124  CCFFFF            ldd #-1
 4127  2031              bra L19
 4129            L20:
 4129                    .dbline 85
 4129  CC0000            ldd #0
 412C  6C1E              std -2,x
 412E            L22:
 412E                    .dbline 85
 412E            ; ä
 412E            ; ä
 412E            ; ä
 412E            ; ä
 412E                    .dbline 86
 412E            ; ä
 412E  EC1C              ldd -4,x
 4130  ED1E              ldy -2,x
 4132  8D0000            cpy #0
 4135  2705              beq X5
 4137            X6:
 4137  47                asra
 4138  56                rorb
 4139  0436FB            dbne y,X6
 413C            X5:
 413C  8400              anda #0
 413E  C401              andb #1
 4140  8C0000            cpd #0
 4143  2704              beq L26
 4145                    .dbline 86
 4145                    .dbline 87
 4145            ; ä
 4145  EC1E              ldd -2,x
 4147  2011              bra L19
 4149            L26:
 4149                    .dbline 89
 4149            L23:
 4149                    .dbline 85
 4149  EC1E              ldd -2,x
 414B  C30001            addd #1
 414E  6C1E              std -2,x
 4150                    .dbline 85
 4150  EC1E              ldd -2,x
 4152  8C0004            cpd #4
 4155  2DD7              blt L22
 4157                    .dbline 91
 4157            ; ä
 4157            ; ä
 4157            ; ä
 4157            ; ä
 4157  CCFFFF            ldd #-1
 415A                    .dbline -2
 415A            L19:
 415A  B757              tfr x,s
 415C  30                pulx
 415D                    .dbline 0 ; func end
 415D  3D                rts
 415E                    .dbsym l input -4 I
 415E                    .dbsym l col -2 I
 415E                    .dbend
 415E                    .dbfunc s keyboard_delay _keyboard_delay fV
 415E            ;          delay -> 2,x
 415E            _keyboard_delay:
 415E  3B                pshd
 415F  34                pshx
 4160  B775              tfr s,x
 4162                    .dbline -1
 4162                    .dbline 98
 4162            ; ä
 4162            ; ä
 4162            ; ä
 4162            ; ä
 4162            ; ä
 4162            ; ä
 4162            ; ä
 4162                    .dbline 99
 4162  2007              bra L32
 4164            L29:
 4164                    .dbline 99
 4164                    .dbline 99
 4164            L30:
 4164                    .dbline 99
 4164  EC02              ldd 2,x
 4166  830001            subd #1
 4169  6C02              std 2,x
 416B            L32:
 416B                    .dbline 99
 416B            ; ä
 416B  EC02              ldd 2,x
 416D  26F5              bne L29
 416F                    .dbline -2
 416F                    .dbline 100
 416F            ; ä
 416F            L28:
 416F  B757              tfr x,s
 4171  30                pulx
 4172  1B82              leas 2,sp
 4174                    .dbline 0 ; func end
 4174  3D                rts
 4175                    .dbsym l delay 2 i
 4175                    .dbend
 4175                    .dbfile M:\SYSC20~2\Assignments\ASSIGN~3\PART1~1\assign41.c
 4175                    .dbfunc e main _main fI
 4175            ;            key -> -1,x
 4175            _main::
 4175  34                pshx
 4176  B775              tfr s,x
 4178  1B9E              leas -2,sp
 417A                    .dbline -1
 417A                    .dbline 6
 417A                    .dbline 10
 417A  CC001A            ldd #26
 417D  16419E            jsr _setbaud
 4180  2013              bra L35
 4182            L34:
 4182                    .dbline 12
 4182                    .dbline 13
 4182  164047            jsr _keyboard_getchar
 4185  6B1F              stab -1,x
 4187                    .dbline 14
 4187  E61F              ldab -1,x
 4189  87                clra
 418A  1641CE            jsr _putchar
 418D                    .dbline 16
 418D  E61F              ldab -1,x
 418F  C130              cmpb #48
 4191  2602              bne L37
 4193                    .dbline 16
 4193                    .dbline 17
 4193  2002              bra L36
 4195            L37:
 4195                    .dbline 19
 4195            L35:
 4195                    .dbline 12
 4195  20EB              bra L34
 4197            L36:
 4197                    .dbline 21
 4197  CC0001            ldd #1
 419A                    .dbline -2
 419A            L33:
 419A  B757              tfr x,s
 419C  30                pulx
 419D                    .dbline 0 ; func end
 419D  3D                rts
 419E                    .dbsym l key -1 c
 419E                    .dbend
